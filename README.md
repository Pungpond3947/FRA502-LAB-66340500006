# THRUST VECTORING DRONE
**FIBO FRA502 â€“ RoboticsDev Final Project 2025**

**Institute of Field Robotics, King Mongkut's University of Technology Thonburi**

06 DEC, 2025

---

## ğŸ“‹ à¸ªà¸²à¸£à¸šà¸±à¸

1. [Overview](#-overview)
2. [Project Objectives](#-project-objectives)
3. [Project Scope & Constraints](#-project-scope--constraints)
4. [System Architecture](#-system-architecture)
5. [General Information](#-general-information)
6. [Control System](#-control-system)
7. [Hardware Design](#-hardware-design)
8. [ROS2 Implementation](#-ros2-implementation)
   - [Simulation Mode](#simulation-mode-gazebo)
   - [Real Hardware Mode](#real-hardware-mode-esp32--microros)
9. [Expected Results](#-expected-results)
10. [Project Timeline](#-project-timeline)
11. [Installation & Setup](#-installation--setup)
12. [Usage](#-usage)

---

## ğŸ¯ Overview

à¹‚à¸„à¸£à¸‡à¸‡à¸²à¸™à¸™à¸µà¹‰à¸¡à¸µà¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œà¹€à¸à¸·à¹ˆà¸­à¸à¸±à¸’à¸™à¸² **Thrust Vectoring Drone** (à¹‚à¸”à¸£à¸™à¹à¸šà¸šà¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¸´à¸¨à¸—à¸²à¸‡à¹à¸£à¸‡à¸‚à¸±à¸š) à¸‹à¸¶à¹ˆà¸‡à¸ªà¸²à¸¡à¸²à¸£à¸–à¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¸´à¸¨à¸—à¸²à¸‡à¸‚à¸­à¸‡à¹à¸£à¸‡à¸‚à¸±à¸šà¹€à¸à¸·à¹ˆà¸­à¸à¸²à¸£à¸—à¸£à¸‡à¸•à¸±à¸§à¹à¸¥à¸°à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸­à¸´à¸ªà¸£à¸° à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰à¸£à¸°à¸šà¸š **ROS2** à¸£à¹ˆà¸§à¸¡à¸à¸±à¸š **MicroROS** à¹€à¸à¸·à¹ˆà¸­à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸„à¸­à¸¡à¸à¸´à¸§à¹€à¸•à¸­à¸£à¹Œà¹à¸¥à¸°à¹„à¸¡à¹‚à¸„à¸£à¸„à¸­à¸™à¹‚à¸—à¸£à¸¥à¹€à¸¥à¸­à¸£à¹Œà¹ƒà¸™à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ

à¸£à¸°à¸šà¸šà¸–à¸¹à¸à¸­à¸­à¸à¹à¸šà¸šà¹ƒà¸«à¹‰à¸à¸±à¹ˆà¸‡à¸„à¸­à¸¡à¸à¸´à¸§à¹€à¸•à¸­à¸£à¹Œà¸—à¸³à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸„à¸§à¸šà¸„à¸¸à¸¡ (à¸à¸²à¸£à¸‚à¸¶à¹‰à¸™à¸šà¸´à¸™, à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸—à¸´à¸¨à¸—à¸²à¸‡, à¸«à¸£à¸·à¸­à¸à¸²à¸£à¸«à¸¢à¸¸à¸”à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™) à¸œà¹ˆà¸²à¸™ Topic à¸ªà¹ˆà¸§à¸™à¸à¸±à¹ˆà¸‡à¹„à¸¡à¹‚à¸„à¸£à¸„à¸­à¸™à¹‚à¸—à¸£à¸¥à¹€à¸¥à¸­à¸£à¹Œà¸ˆà¸°à¸—à¸³à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” à¹„à¸”à¹‰à¹à¸à¹ˆ à¸à¸²à¸£à¸­à¹ˆà¸²à¸™à¸„à¹ˆà¸²à¸ˆà¸²à¸à¹€à¸‹à¸™à¹€à¸‹à¸­à¸£à¹Œ IMU, à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸—à¹ˆà¸²à¸—à¸²à¸‡, à¹à¸¥à¸°à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¸´à¸¨à¸—à¸²à¸‡à¸‚à¸­à¸‡à¹à¸£à¸‡à¸‚à¸±à¸šà¸”à¹‰à¸§à¸¢ PID Controller

**à¸„à¸³à¸ªà¸³à¸„à¸±à¸:** ROS2, MicroROS, Monorotor Drone, PID Controller, Real-Time Communication

---

## ğŸ¯ Project Objectives

1. **à¹€à¸à¸·à¹ˆà¸­à¸à¸±à¸’à¸™à¸²à¹‚à¸”à¸£à¸™à¹ƒà¸šà¸à¸±à¸”à¹€à¸”à¸µà¸¢à¸§à¸—à¸µà¹ˆà¸„à¸§à¸šà¸„à¸¸à¸¡à¸”à¹‰à¸§à¸¢ Thrust Vectoring à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸ªà¸–à¸µà¸¢à¸£**
   - à¹ƒà¸Šà¹‰à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸¡à¸¸à¸¡à¹€à¸­à¸µà¸¢à¸‡à¸‚à¸­à¸‡à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¹€à¸à¸·à¹ˆà¸­à¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¸´à¸¨à¸—à¸²à¸‡à¹à¸£à¸‡à¸‚à¸±à¸šà¹à¸—à¸™à¸à¸²à¸£à¹€à¸à¸´à¹ˆà¸¡à¸ˆà¸³à¸™à¸§à¸™à¹ƒà¸šà¸à¸±à¸”
   - à¸Šà¹ˆà¸§à¸¢à¸¥à¸”à¸™à¹‰à¸³à¸«à¸™à¸±à¸à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™à¸‚à¸­à¸‡à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸”à¸£à¸™

2. **à¹€à¸à¸·à¹ˆà¸­à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸£à¸°à¸šà¸š ROS2 à¹à¸¥à¸° MicroROS à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¹à¸¥à¸°à¸ªà¸±à¹ˆà¸‡à¸‡à¸²à¸™à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œà¸œà¹ˆà¸²à¸™ Wi-Fi**
   - à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¸œà¹ˆà¸²à¸™à¸­à¸´à¸™à¹€à¸—à¸­à¸£à¹Œà¹€à¸™à¹‡à¸•à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ MicroROS Agent
   - à¸£à¸°à¸šà¸šà¸—à¸³à¸‡à¸²à¸™à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ

3. **à¹€à¸à¸·à¹ˆà¸­à¸¨à¸¶à¸à¸©à¸²à¸„à¸§à¸²à¸¡à¸ªà¸²à¸¡à¸²à¸£à¸–à¹ƒà¸™à¸à¸²à¸£à¸—à¸£à¸‡à¸•à¸±à¸§ à¸à¸²à¸£à¸•à¸­à¸šà¸ªà¸™à¸­à¸‡à¸•à¹ˆà¸­à¸„à¸³à¸ªà¸±à¹ˆà¸‡ à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸”à¹‰à¹ƒà¸™à¸à¸²à¸£à¸•à¹ˆà¸­à¸¢à¸­à¸”à¸ªà¸¹à¹ˆà¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¹à¸šà¸šà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹ƒà¸™à¸­à¸™à¸²à¸„à¸•**

---

## ğŸ“‹ Project Scope & Constraints

### à¸‚à¸­à¸šà¹€à¸‚à¸•à¹‚à¸„à¸£à¸‡à¸à¸²à¸£

1. à¹ƒà¸Šà¹‰ **ROS2** à¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸„à¸§à¸šà¸„à¸¸à¸¡à¸à¸²à¸£à¸šà¸´à¸™
2. à¹ƒà¸Šà¹‰à¹„à¸¡à¹‚à¸„à¸£à¸„à¸­à¸™à¹‚à¸—à¸£à¸¥à¹€à¸¥à¸­à¸£à¹Œ **ESP32** à¸—à¸µà¹ˆà¸£à¸±à¸™ **MicroROS** à¹ƒà¸™à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡ PID à¹à¸¥à¸°à¸à¸²à¸£à¸£à¸±à¸à¸©à¸²à¸ªà¸¡à¸”à¸¸à¸¥
3. à¸£à¸°à¸šà¸šà¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¸œà¹ˆà¸²à¸™ **Wi-Fi Network / Local Network** à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ UART
4. à¹ƒà¸Šà¹‰ **IMU** à¹ƒà¸™à¸à¸²à¸£à¸§à¸±à¸” pitch, roll, yaw à¸‚à¸­à¸‡à¹‚à¸”à¸£à¸™
5. à¹ƒà¸Šà¹‰à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¸—à¸µà¹ˆà¸›à¸£à¸±à¸šà¸¡à¸¸à¸¡à¹€à¸­à¸µà¸¢à¸‡à¹„à¸”à¹‰ à¹€à¸à¸·à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¹à¸šà¸š **Thrust Vectoring**
6. à¹à¸ªà¸”à¸‡à¸œà¸¥à¹à¸¥à¸°à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°à¹‚à¸”à¸£à¸™à¸œà¹ˆà¸²à¸™ **Rviz**

### à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸”à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™

- **à¸„à¸§à¸²à¸¡à¸ªà¸¹à¸‡à¸à¸²à¸£à¸šà¸´à¸™:** à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™ 4 à¹€à¸¡à¸•à¸£
- **à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸à¸²à¸£à¸šà¸´à¸™:** à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™ 5 à¸™à¸²à¸—à¸µ
- **à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸—à¸”à¸ªà¸­à¸š:** à¹ƒà¸™à¸«à¹‰à¸­à¸‡à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£à¸«à¸£à¸·à¸­à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸›à¸¥à¸­à¸”à¸ à¸±à¸¢

---

## ğŸ—ï¸ System Architecture

### System Overview

à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸™à¸µà¹‰à¸¡à¸µ 2 à¹‚à¸«à¸¡à¸”à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™:

| Mode | Description | Data Source | Use Case |
|------|-------------|-------------|----------|
| **ğŸ–¥ï¸ Simulation** | à¸—à¸”à¸ªà¸­à¸šà¹ƒà¸™ Gazebo | Gazebo Physics Engine | Development & Testing |
| **ğŸš Real Hardware** | à¸šà¸´à¸™à¸ˆà¸£à¸´à¸‡à¸”à¹‰à¸§à¸¢ ESP32 | ESP32 + MicroROS + Sensors | Real Flight |

### System Components Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      THRUST VECTORING DRONE SYSTEM                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      ğŸ–¥ï¸ SIMULATION MODE         â”‚      ğŸš REAL HARDWARE MODE        â”‚
â”‚         (Gazebo)                â”‚      (ESP32 + MicroROS)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   GAZEBO SIMULATION   â”‚     â”‚     â”‚   ESP32 + MicroROS    â”‚    â”‚
â”‚  â”‚                       â”‚     â”‚     â”‚                       â”‚    â”‚
â”‚  â”‚  â€¢ Physics Engine     â”‚     â”‚     â”‚  â€¢ IMU Sensor         â”‚    â”‚
â”‚  â”‚  â€¢ Drone Model        â”‚     â”‚     â”‚  â€¢ TOF Sensor         â”‚    â”‚
â”‚  â”‚  â€¢ Environment        â”‚     â”‚     â”‚  â€¢ PID Controller     â”‚    â”‚
â”‚  â”‚                       â”‚     â”‚     â”‚  â€¢ Servo Control      â”‚    â”‚
â”‚  â”‚  Publishers:          â”‚     â”‚     â”‚                       â”‚    â”‚
â”‚  â”‚  â€¢ /odom              â”‚     â”‚     â”‚  Publishers:          â”‚    â”‚
â”‚  â”‚  â€¢ /tf                â”‚     â”‚     â”‚  â€¢ /drone/pose        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚  â€¢ /drone/imu         â”‚    â”‚
â”‚              â”‚                 â”‚     â”‚  â€¢ /drone/status      â”‚    â”‚
â”‚              â–¼                 â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                 â”‚                â”‚
â”‚  â”‚    PC (ROS2 Nodes)    â”‚     â”‚            UDP  â”‚ Wi-Fi          â”‚
â”‚  â”‚                       â”‚     â”‚                 â–¼                â”‚
â”‚  â”‚  â€¢ drone_pose_node    â”‚     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ fin_sim_node       â”‚     â”‚     â”‚    PC (ROS2 Agent)    â”‚    â”‚
â”‚  â”‚  â€¢ teleop_node        â”‚     â”‚     â”‚                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚  â€¢ MicroROS Agent     â”‚    â”‚
â”‚              â”‚                 â”‚     â”‚  â€¢ RVIZ2              â”‚    â”‚
â”‚              â–¼                 â”‚     â”‚  â€¢ Teleop             â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”‚       RVIZ2           â”‚     â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                   â”‚
â”‚                                 â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š General Information

### Project Specifications

| Parameter | Value | Unit | Notes |
|-----------|-------|------|-------|
| **Platform** | ESP32 + MicroROS | - | Embedded flight controller |
| **Communication** | Wi-Fi/UDP | - | Real-time MicroROS Agent |
| **Flight Altitude** | â‰¤ 4 | meters | Safety constraint |
| **Flight Duration** | â‰¤ 5 | minutes | Battery limitation |
| **Control Type** | Thrust Vectoring | - | Single propeller + 4 fins |
| **Sensors** | IMU + TOF | - | Attitude + altitude sensing |

### Performance Targets

| Parameter | Target Accuracy | Unit | Description |
|-----------|----------------|------|-------------|
| **Attitude Control** | Â±10 | degrees | Roll, Pitch, Yaw precision |
| **Altitude Control** | Â±5 | cm | Height maintenance accuracy |
| **Communication** | Low latency | ms | ROS2 â†” MicroROS stability |
| **Disturbance Rejection** | Small | - | PID stability under wind |

---

## ğŸ® Control System

### PID Controller Architecture

à¸£à¸°à¸šà¸šà¹ƒà¸Šà¹‰ **PID Controller** à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸à¸²à¸£à¸šà¸´à¸™à¸—à¸µà¹ˆà¹€à¸ªà¸–à¸µà¸¢à¸£à¹à¸¥à¸°à¹à¸¡à¹ˆà¸™à¸¢à¸³ à¹‚à¸”à¸¢ ESP32 à¸—à¸³à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥ PID à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Target  â”‚â”€â”€â”€â–¶â”‚   PID    â”‚â”€â”€â”€â–¶â”‚ SERVO +        â”‚â”€â”€â”€â–¶â”‚ Output  â”‚
â”‚Setpoint â”‚    â”‚Controllerâ”‚    â”‚ THRUSTER       â”‚    â”‚ [4 fins â”‚
â”‚(ROS2)   â”‚    â”‚(ESP32)   â”‚    â”‚ CONTROLLER     â”‚    â”‚+ thrust]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚          â”‚    â”‚                â”‚    â”‚         â”‚
               â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
               â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
               â”‚   IMU    â”‚
               â”‚   TOF    â”‚
               â”‚ Feedback â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               
Input: roll, pitch, yaw, altitude setpoints (via ROS2)
Output: 4 fin angles + thruster speed
```

### PID Controller Implementation

**Multi-loop PID Structure:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESP32 PID CONTROLLER                        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ROLL PID   â”‚  â”‚ PITCH PID   â”‚  â”‚  YAW PID    â”‚            â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚            â”‚
â”‚  â”‚ Kp, Ki, Kd  â”‚  â”‚ Kp, Ki, Kd  â”‚  â”‚ Kp, Ki, Kd  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                â”‚                â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   FIN 1     â”‚  â”‚   FIN 2     â”‚  â”‚   FIN 3     â”‚            â”‚
â”‚  â”‚   SERVO     â”‚  â”‚   SERVO     â”‚  â”‚   SERVO     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ALTITUDE PID â”‚                  â”‚   FIN 4     â”‚            â”‚
â”‚  â”‚             â”‚                  â”‚   SERVO     â”‚            â”‚
â”‚  â”‚ Kp, Ki, Kd  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚             â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚  THRUSTER   â”‚                                              â”‚
â”‚  â”‚    ESC      â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**PID Equations:**

```
u(t) = Kp * e(t) + Ki * âˆ«e(t)dt + Kd * de(t)/dt

Where:
e(t) = setpoint - measurement
Kp = Proportional gain
Ki = Integral gain  
Kd = Derivative gain
```

### Thrust Vectoring Logic

**à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¸´à¸¨à¸—à¸²à¸‡à¹à¸£à¸‡à¸‚à¸±à¸š:**

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  THRUST VECTOR  â”‚
                    â”‚    CONTROL      â”‚
                    â”‚                 â”‚
         Roll   â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€ Fin 1 Angle
         Pitch  â”€â”€â”€â”€â”¤  ESP32 + PID    â”œâ”€â”€â”€â”€ Fin 2 Angle  
         Yaw    â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€ Fin 3 Angle
         Alt    â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€ Fin 4 Angle
                    â”‚                 â”‚
         IMU    â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€ Thrust Level
         TOF    â”€â”€â”€â”€â”¤                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Hardware Design

### Thrust Vane Mechanism

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      THRUST VANE FORCE               â”‚
â”‚                                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚           â”‚ SERVO  â”‚                 â”‚
â”‚           â”‚ MOTOR  â”‚                 â”‚
â”‚           â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â”‚
â”‚               â”‚                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                â”‚
â”‚         â”‚   THRUST  â”‚                â”‚
â”‚         â”‚    VANE   â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚               â”‚                      â”‚
â”‚               â–¼                      â”‚
â”‚         Vectored Thrust              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Airfoil Design

à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸¡à¸µà¸à¸²à¸£à¸­à¸­à¸à¹à¸šà¸š **Airfoil** à¸ªà¸³à¸«à¸£à¸±à¸š thrust vanes à¹€à¸à¸·à¹ˆà¸­à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸ªà¸¹à¸‡à¸ªà¸¸à¸”

- à¹ƒà¸Šà¹‰à¸«à¸¥à¸±à¸à¸à¸²à¸£ aerodynamics
- à¸­à¸­à¸à¹à¸šà¸šà¹ƒà¸«à¹‰à¸¡à¸µà¹à¸£à¸‡à¸•à¹‰à¸²à¸™à¸•à¹ˆà¸³
- à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸ªà¸¹à¸‡à¹ƒà¸™à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸—à¸´à¸¨à¸—à¸²à¸‡à¹à¸£à¸‡à¸‚à¸±à¸š

---

## ğŸš€ ROS2 Implementation

à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸™à¸µà¹‰à¸¡à¸µ 2 à¹‚à¸«à¸¡à¸”à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ topics à¹à¸¥à¸° data flow à¸—à¸µà¹ˆà¹à¸•à¸à¸•à¹ˆà¸²à¸‡à¸à¸±à¸™:

---

### ğŸ–¥ï¸ Simulation Mode (Gazebo)

> **à¸ªà¸–à¸²à¸™à¸°:** à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸à¸±à¸’à¸™à¸²à¹à¸¥à¸°à¸—à¸”à¸ªà¸­à¸š

à¹ƒà¸™à¹‚à¸«à¸¡à¸” Simulation à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸¡à¸²à¸ˆà¸²à¸ **Gazebo Physics Engine** à¹‚à¸”à¸¢ RVIZ à¸ˆà¸°à¹à¸ªà¸”à¸‡à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸ˆà¸²à¸ simulation

#### Simulation System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GAZEBO SIMULATION                            â”‚
â”‚                                                                     â”‚
â”‚  â€¢ Physics Engine          â€¢ Drone Model        â€¢ Environment       â”‚
â”‚                                                                     â”‚
â”‚  Publishers:                      Subscribers:                      â”‚
â”‚  â€¢ /odom (position & velocity)    â€¢ /drone/velocity_setpoint        â”‚
â”‚  â€¢ /tf (world transforms)                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ ROS2 Topics
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PC (ROS2 NODES)                             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   TELEOP    â”‚     â”‚ DRONE_POSE  â”‚     â”‚  FIN_SIM    â”‚          â”‚
â”‚  â”‚   NODE      â”‚     â”‚    NODE     â”‚     â”‚    NODE     â”‚          â”‚
â”‚  â”‚             â”‚     â”‚             â”‚     â”‚             â”‚          â”‚
â”‚  â”‚ Pub:        â”‚     â”‚ Sub: /odom  â”‚     â”‚ Sub: /tf    â”‚          â”‚
â”‚  â”‚ /drone/     â”‚     â”‚    (Gazebo) â”‚     â”‚    (Gazebo) â”‚          â”‚
â”‚  â”‚ velocity_   â”‚     â”‚             â”‚     â”‚             â”‚          â”‚
â”‚  â”‚ setpoint    â”‚     â”‚ Pub: /tf    â”‚     â”‚ Pub:        â”‚          â”‚
â”‚  â”‚     â”‚       â”‚     â”‚ (base_link  â”‚     â”‚ /fin_states â”‚          â”‚
â”‚  â”‚     â”‚       â”‚     â”‚  â†’body_droneâ”‚     â”‚             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚        â”‚                    â”‚                   â”‚                  â”‚
â”‚        â”‚ To Gazebo          â–¼                   â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        RVIZ2                                â”‚  â”‚
â”‚  â”‚  â€¢ Drone 3D Model      â† /robot_description                 â”‚  â”‚
â”‚  â”‚  â€¢ Position/Orientation â† /tf (from Gazebo)                 â”‚  â”‚
â”‚  â”‚  â€¢ Fin Angles          â† /fin_states                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Simulation Nodes

##### 1. Drone Pose Node (drone_pose.py)
```python
# Publishers
/tf                  # Transform: base_link â†’ body_drone

# Subscribers
/odom                # Odometry data from Gazebo (nav_msgs/Odometry)
```

##### 2. Fin Angle Node (fin_sim.py)
```python
# Publishers
/fin_states          # Joint states (sensor_msgs/JointState)
                     # Joints: fin_1_joint, fin_2_joint, fin_3_joint, fin_4_joint

# Subscribers
/tf                  # TF transforms from Gazebo (tf2_msgs/TFMessage)
```

##### 3. Teleop Node (teleop.py)
```python
# Publishers
/drone/velocity_setpoint    # Velocity commands (geometry_msgs/Vector3)

# Controls (World Frame):
#   w : +X (Forward)
#   s : -X (Backward)
#   a : +Y (Left)
#   d : -Y (Right)
#   space : +Z (Up)
#   c : -Z (Down)
#   CTRL-C : Quit
```

#### Simulation Topic Summary

| Topic | Message Type | Publisher | Subscriber |
|-------|-------------|-----------|------------|
| `/odom` | nav_msgs/Odometry | **Gazebo** | drone_pose_node |
| `/tf` | tf2_msgs/TFMessage | drone_pose_node, **Gazebo** | fin_sim_node, RVIZ2 |
| `/fin_states` | sensor_msgs/JointState | fin_sim_node | robot_state_publisher |
| `/drone/velocity_setpoint` | geometry_msgs/Vector3 | teleop_node | **Gazebo** |
| `/robot_description` | std_msgs/String | robot_state_publisher | RVIZ2 |

#### Running Simulation

```bash
# Terminal 1: Launch Gazebo simulation
ros2 launch thrust_vectoring_drone gazebo_launch.py

# Terminal 2: Launch RVIZ2
ros2 launch thrust_vectoring_drone rviz_launch.py

# Terminal 3: Start teleop
ros2 run thrust_vectoring_drone teleop.py

# Terminal 4: Monitor topics
ros2 topic echo /odom
ros2 topic echo /tf
```

---

### ğŸš Real Hardware Mode (ESP32 + MicroROS)

> **à¸ªà¸–à¸²à¸™à¸°:** à¸­à¸¢à¸¹à¹ˆà¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸à¸²à¸£à¸à¸±à¸’à¸™à¸² (Week 3-4)

à¹ƒà¸™à¹‚à¸«à¸¡à¸” Real Hardware à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¡à¸²à¸ˆà¸²à¸ **ESP32 + MicroROS** à¸—à¸µà¹ˆà¸­à¹ˆà¸²à¸™à¸„à¹ˆà¸²à¸ˆà¸²à¸ sensors à¸ˆà¸£à¸´à¸‡ (IMU, TOF) à¹à¸¥à¸°à¸ªà¹ˆà¸‡à¸œà¹ˆà¸²à¸™ Wi-Fi

#### Real Hardware System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESP32 + MicroROS (DRONE)                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    FLIGHT CONTROLLER                         â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚  â”‚     IMU     â”‚  â”‚ TOF SENSOR  â”‚  â”‚ PID CONTROL â”‚         â”‚  â”‚
â”‚  â”‚  â”‚  (MPU6050)  â”‚  â”‚             â”‚  â”‚             â”‚         â”‚  â”‚
â”‚  â”‚  â”‚             â”‚  â”‚ â€¢ Altitude  â”‚  â”‚ â€¢ Roll      â”‚         â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Roll      â”‚  â”‚             â”‚  â”‚ â€¢ Pitch     â”‚         â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Pitch     â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ Yaw       â”‚         â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Yaw       â”‚         â”‚         â”‚ â€¢ Altitude  â”‚         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â”‚         â”‚                â”‚                â”‚                 â”‚  â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚  â”‚                          â”‚                                   â”‚  â”‚
â”‚  â”‚                          â–¼                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚              MicroROS NODE                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Publishers:                                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /drone/pose        (geometry_msgs/Pose)          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /drone/imu         (sensor_msgs/Imu)             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /drone/status      (diagnostic_msgs/Status)      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /drone/angle       (std_msgs/Float64MultiArray)  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Subscribers:                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /cmd_vel           (geometry_msgs/Twist)         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ /drone/setpoint    (geometry_msgs/Point)         â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    HARDWARE INTERFACE                        â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚  â€¢ 4x Servo Motors (Fin Control)                            â”‚  â”‚
â”‚  â”‚  â€¢ 1x ESC + Brushless Motor (Thrust)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                           UDP  â”‚ Wi-Fi (MicroROS Agent)
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PC (ROS2 AGENT)                             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  MicroROS Agent â”‚     â”‚     TELEOP      â”‚                       â”‚
â”‚  â”‚                 â”‚     â”‚                 â”‚                       â”‚
â”‚  â”‚ â€¢ UDP Bridge    â”‚     â”‚ Pub: /cmd_vel   â”‚                       â”‚
â”‚  â”‚ â€¢ Topic Relay   â”‚     â”‚                 â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚           â”‚                       â”‚                                 â”‚
â”‚           â–¼                       â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        RVIZ2                                â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Subscribers:                                               â”‚  â”‚
â”‚  â”‚  â€¢ /drone/pose       â† Position from ESP32                  â”‚  â”‚
â”‚  â”‚  â€¢ /drone/imu        â† IMU data from ESP32                  â”‚  â”‚
â”‚  â”‚  â€¢ /drone/angle      â† Attitude angles from ESP32           â”‚  â”‚
â”‚  â”‚  â€¢ /robot_description                                       â”‚  â”‚
â”‚  â”‚  â€¢ /tf                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Real Hardware Nodes

##### 1. MicroROS Node (ESP32)
```cpp
// Publishers (from ESP32 to PC)
/drone/pose        // geometry_msgs/Pose - Position from sensors
/drone/imu         // sensor_msgs/Imu - Raw IMU data
/drone/status      // diagnostic_msgs/Status - System health
/drone/angle       // std_msgs/Float64MultiArray - [roll, pitch, yaw]

// Subscribers (from PC to ESP32)
/cmd_vel           // geometry_msgs/Twist - Velocity commands
/drone/setpoint    // geometry_msgs/Point - Position setpoint
```

##### 2. Teleop Node (PC)
```python
# Publishers
/cmd_vel                    # Twist messages for drone control

# Alternative: teleop_twist_keyboard
ros2 run teleop_twist_keyboard teleop_twist_keyboard
```

##### 3. RVIZ2 (PC)
```python
# Subscribers (Real Hardware Mode)
/drone/pose        # Position from ESP32 (NOT from /odom)
/drone/imu         # IMU visualization
/drone/angle       # Attitude display
/robot_description # URDF model
/tf                # Transform tree
```

#### Real Hardware Topic Summary

| Topic | Message Type | Publisher | Subscriber |
|-------|-------------|-----------|------------|
| `/drone/pose` | geometry_msgs/Pose | **ESP32** | RVIZ2 |
| `/drone/imu` | sensor_msgs/Imu | **ESP32** | RVIZ2 |
| `/drone/angle` | std_msgs/Float64MultiArray | **ESP32** | RVIZ2 |
| `/drone/status` | diagnostic_msgs/Status | **ESP32** | Monitor |
| `/cmd_vel` | geometry_msgs/Twist | Teleop | **ESP32** |
| `/drone/setpoint` | geometry_msgs/Point | PC | **ESP32** |

#### Running Real Hardware

```bash
# Terminal 1: Start MicroROS Agent
ros2 run micro_ros_agent micro_ros_agent udp4 --port 8888

# Terminal 2: Launch RVIZ2 (Real Hardware config)
ros2 launch thrust_vectoring_drone rviz_real_launch.py

# Terminal 3: Start teleop
ros2 run teleop_twist_keyboard teleop_twist_keyboard

# Terminal 4: Monitor drone status
ros2 topic echo /drone/pose
ros2 topic echo /drone/imu
ros2 topic echo /drone/status
```

---

### ğŸ“Š Mode Comparison

| Feature | ğŸ–¥ï¸ Simulation | ğŸš Real Hardware |
|---------|---------------|------------------|
| **Data Source** | Gazebo Physics | ESP32 Sensors |
| **Position Topic** | `/odom` | `/drone/pose` |
| **IMU Data** | Gazebo plugin | `/drone/imu` |
| **Control Input** | `/drone/velocity_setpoint` | `/cmd_vel` |
| **Communication** | Local ROS2 | Wi-Fi + MicroROS |
| **RVIZ Config** | `rviz_launch.py` | `rviz_real_launch.py` |
| **Use Case** | Development, Testing | Flight Testing |

### Topic Mapping

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TOPIC COMPARISON                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ğŸ–¥ï¸ SIMULATION         â”‚   ğŸš REAL HARDWARE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /odom                   â”‚ /drone/pose                           â”‚
â”‚ (nav_msgs/Odometry)     â”‚ (geometry_msgs/Pose)                  â”‚
â”‚ Source: Gazebo          â”‚ Source: ESP32 + IMU + TOF             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /tf (from Gazebo)       â”‚ /drone/imu                            â”‚
â”‚                         â”‚ (sensor_msgs/Imu)                     â”‚
â”‚                         â”‚ Source: ESP32 + MPU6050               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /drone/velocity_setpointâ”‚ /cmd_vel                              â”‚
â”‚ (geometry_msgs/Vector3) â”‚ (geometry_msgs/Twist)                 â”‚
â”‚ To: Gazebo Controller   â”‚ To: ESP32 PID Controller              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /fin_states             â”‚ /drone/angle                          â”‚
â”‚ (sensor_msgs/JointState)â”‚ (std_msgs/Float64MultiArray)          â”‚
â”‚ Source: fin_sim_node    â”‚ Source: ESP32                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Expected Results

### Performance Targets

1. **à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸—à¹ˆà¸²à¸—à¸²à¸‡ (Attitude Control)**
   - à¸ªà¸²à¸¡à¸²à¸£à¸–à¸„à¸§à¸šà¸„à¸¸à¸¡à¹‚à¸”à¸£à¸™à¹ƒà¸«à¹‰à¸„à¸§à¸šà¸„à¸¸à¸¡à¸­à¸‡à¸¨à¸²à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡à¹„à¸”à¹‰
   - **Target Error:** â‰¤ Â±10 degrees (Roll, Pitch, Yaw)

2. **à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸„à¸§à¸²à¸¡à¸ªà¸¹à¸‡ (Altitude Control)**  
   - à¸•à¸±à¸§à¹‚à¸”à¸£à¸™à¸ªà¸²à¸¡à¸²à¸£à¸–à¸£à¸±à¸à¸©à¸²à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸„à¸§à¸²à¸¡à¸ªà¸¹à¸‡à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹ƒà¸«à¹‰à¹„à¸”à¹‰
   - **Target Error:** â‰¤ Â±5 cm

3. **à¸à¸²à¸£à¸—à¸£à¸‡à¸•à¸±à¸§ (Hovering Capability)**
   - à¹‚à¸”à¸£à¸™à¸ªà¸²à¸¡à¸²à¸£à¸–à¸¥à¸­à¸¢à¸•à¸±à¸§à¹„à¸”à¹‰à¸”à¹‰à¸§à¸¢à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¹à¸šà¸š Thrust Vectoring
   - à¹€à¸ªà¸–à¸µà¸¢à¸£à¸ à¸²à¸à¹ƒà¸™à¸à¸²à¸£à¸¥à¸­à¸¢à¸•à¸±à¸§à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¹€à¸‹à¸²à¸°à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡

4. **à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£ (Communication Performance)**
   - à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£ ROS2 â†” MicroROS à¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸ªà¸–à¸µà¸¢à¸£à¹à¸¥à¸°à¸«à¸™à¹ˆà¸§à¸‡à¸•à¹ˆà¸³
   - Latency < 50ms à¸ªà¸³à¸«à¸£à¸±à¸š critical commands

5. **à¸„à¸§à¸²à¸¡à¸—à¸™à¸—à¸²à¸™à¸•à¹ˆà¸­à¸ªà¸´à¹ˆà¸‡à¸£à¸šà¸à¸§à¸™ (Disturbance Rejection)**
   - PID à¸ªà¸²à¸¡à¸²à¸£à¸–à¸£à¸±à¸à¸©à¸²à¸ªà¸¡à¸”à¸¸à¸¥à¸‚à¸­à¸‡à¹‚à¸”à¸£à¸™à¹„à¸”à¹‰à¸ à¸²à¸¢à¹ƒà¸•à¹‰ disturbance à¸‚à¸™à¸²à¸”à¹€à¸¥à¹‡à¸
   - à¸à¸²à¸£à¸•à¸­à¸šà¸ªà¸™à¸­à¸‡à¸•à¹ˆà¸­à¸¥à¸¡à¹€à¸šà¸² à¹† à¸«à¸£à¸·à¸­à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¹‚à¸«à¸¥à¸”

6. **à¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸œà¸¥à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ (Real-time Visualization)**
   - à¹à¸ªà¸”à¸‡à¸—à¸´à¸¨à¸—à¸²à¸‡à¹à¸£à¸‡à¸‚à¸±à¸šà¹à¸¥à¸°à¸—à¹ˆà¸²à¸—à¸²à¸‡à¸‚à¸­à¸‡à¹‚à¸”à¸£à¸™à¹ƒà¸™ Rviz à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
   - à¸à¸²à¸£à¸¡à¸­à¸™à¸´à¹€à¸•à¸­à¸£à¹Œà¸ªà¸–à¸²à¸™à¸°à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ

### Success Criteria

âœ… **Phase 1: System Integration**
- MicroROS communication established
- Basic sensor data acquisition
- Servo control functional

âœ… **Phase 2: Control Implementation**  
- PID controllers tuned and stable
- Thrust vectoring mechanism working
- Real-time performance achieved

âœ… **Phase 3: Flight Testing**
- Successful hover for 30+ seconds  
- Attitude control within error bounds
- Safe landing and recovery

---

## ğŸ“… Project Timeline

### Development Schedule (6 Weeks)

| Week | Tasks | Deliverables | Status |
|------|-------|-------------|--------|
| **Week 1** | à¸­à¸­à¸à¹à¸šà¸šà¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¸°à¸£à¸°à¸šà¸šà¸‚à¸­à¸‡à¹‚à¸”à¸£à¸™<br>â€¢ Frame design<br>â€¢ Motor & ESC selection<br>â€¢ Flight controller planning | â€¢ CAD models<br>â€¢ Component list<br>â€¢ System architecture | âœ… Complete |
| **Week 2** | à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² MicroROS à¸šà¸™ ESP32<br>â€¢ ESP32 firmware development<br>â€¢ ROS2 setup on PC | â€¢ Working MicroROS node<br>â€¢ Basic communication test | âœ… Complete |
| **Week 3** | à¸à¸±à¸’à¸™à¸² Communication Code<br>â€¢ WiFi communication<br>â€¢ Topic structure<br>â€¢ Message protocols | â€¢ Stable MicroROS â†” ROS2 link<br>â€¢ Real-time data exchange | ğŸ”„ In Progress |
| **Week 4** | à¸à¸±à¸’à¸™à¸²à¸£à¸°à¸šà¸šà¸„à¸§à¸šà¸„à¸¸à¸¡à¸à¸²à¸£à¸šà¸´à¸™à¹€à¸šà¸·à¹‰à¸­à¸‡à¸•à¹‰à¸™<br>â€¢ PID implementation<br>â€¢ Node/Topic/Service structure | â€¢ Flight control nodes<br>â€¢ Basic control algorithms | â³ Pending |
| **Week 5** | à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸šà¹à¸¥à¸°à¸›à¸£à¸±à¸šà¸ˆà¸¹à¸™à¸à¸²à¸£à¸²à¸¡à¸´à¹€à¸•à¸­à¸£à¹Œ<br>â€¢ Sensor integration testing<br>â€¢ PID tuning<br>â€¢ Real flight tests | â€¢ Tuned parameters<br>â€¢ Flight test results<br>â€¢ Performance validation | â³ Pending |
| **Week 6** | Final Integration & Documentation<br>â€¢ System optimization<br>â€¢ Documentation<br>â€¢ Project presentation | â€¢ Final demo<br>â€¢ Technical report<br>â€¢ Project presentation | â³ Pending |

### Current Milestone Status

ğŸ¯ **Current Focus: Week 3**
- Establishing robust WiFi communication
- Implementing MicroROS topic structure  
- Testing real-time data exchange reliability
- **ğŸ–¥ï¸ Simulation testing in Gazebo**

ğŸ“‹ **Next Steps:**
1. Complete communication stability testing
2. Begin PID controller implementation  
3. Integrate IMU sensor processing
4. Develop servo control algorithms
5. **ğŸš Transition to real hardware testing**

---

## ğŸ’» Installation & Setup

### Prerequisites

**Hardware Requirements:**
- Drone hardware with flight controller
- WiFi module for communication
- Sensors: IMU, GPS, TOF, OLED
- 4x Servos + ESC + Ducted fan

**Software Requirements:**
- Ubuntu 22.04 (Jammy)
- ROS2 Humble
- Python 3.10+
- Gazebo (for simulation)

### Installation Steps

#### 1. Install ROS2 Humble

```bash
# Setup sources
sudo apt update && sudo apt install locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
export LANG=en_US.UTF-8

# Setup ROS2 repository
sudo apt install software-properties-common
sudo add-apt-repository universe
sudo apt update && sudo apt install curl -y
sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU_CODENAME) main" | sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null

# Install ROS2 Humble
sudo apt update
sudo apt install ros-humble-desktop
```

#### 2. Install Dependencies

```bash
# ROS2 packages
sudo apt install ros-humble-gazebo-ros-pkgs
sudo apt install ros-humble-rviz2
sudo apt install ros-humble-robot-state-publisher
sudo apt install ros-humble-joint-state-publisher
sudo apt install ros-humble-teleop-twist-keyboard

# MicroROS Agent (for real hardware)
sudo apt install ros-humble-micro-ros-agent

# Python packages
pip install numpy scipy matplotlib
pip install pyserial
```

#### 3. Clone and Build Workspace

```bash
# Create workspace
mkdir -p ~/ros2_ws/src
cd ~/ros2_ws/src

# Clone repository
git clone https://github.com/yourusername/thrust_vectoring_drone.git

# Build workspace
cd ~/ros2_ws
colcon build --symlink-install

# Source workspace
source ~/ros2_ws/install/setup.bash
```

#### 4. Configure Network (Real Hardware Only)

**On Drone (ESP32 Client):**
```cpp
// In ESP32 firmware
#define WIFI_SSID "your_wifi_ssid"
#define WIFI_PASSWORD "your_wifi_password"
#define AGENT_IP "192.168.1.xxx"  // PC IP address
#define AGENT_PORT 8888
```

**On PC (Agent):**
```bash
# Set ROS_DOMAIN_ID
echo "export ROS_DOMAIN_ID=0" >> ~/.bashrc

# Set RMW implementation
echo "export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp" >> ~/.bashrc

source ~/.bashrc
```

---

## ğŸ¯ Usage

### ğŸ–¥ï¸ Running Simulation Mode

```bash
# Terminal 1: Launch Gazebo simulation
ros2 launch thrust_vectoring_drone gazebo_launch.py

# Terminal 2: Launch RVIZ2
ros2 launch thrust_vectoring_drone rviz_launch.py

# Terminal 3: Start teleop (simulation)
ros2 run thrust_vectoring_drone teleop.py

# Terminal 4: Monitor topics
ros2 topic list
ros2 topic echo /odom
```

### ğŸš Running Real Hardware Mode

```bash
# Terminal 1: Start MicroROS Agent
ros2 run micro_ros_agent micro_ros_agent udp4 --port 8888

# Terminal 2: Launch RVIZ2 (real hardware config)
ros2 launch thrust_vectoring_drone rviz_real_launch.py

# Terminal 3: Start teleop
ros2 run teleop_twist_keyboard teleop_twist_keyboard

# Terminal 4: Monitor drone
ros2 topic echo /drone/pose
ros2 topic echo /drone/imu
ros2 topic echo /drone/status
```

### Control Commands

**ğŸ–¥ï¸ Simulation Teleop (teleop.py):**
```
Moving around (World Frame):
   w : +X (Forward)
   s : -X (Backward)
   a : +Y (Left)
   d : -Y (Right)
   space : +Z (Up)
   c : -Z (Down)
   CTRL-C : Quit
```

**ğŸš Real Hardware Teleop (teleop_twist_keyboard):**
```
Moving around:
   u    i    o
   j    k    l
   m    ,    .

q/z : increase/decrease max speeds by 10%
w/x : increase/decrease only linear speed by 10%
e/c : increase/decrease only angular speed by 10%

CTRL-C to quit
```

### ROS2 Commands

```bash
# Check available topics
ros2 topic list

# Monitor simulation data
ros2 topic echo /odom                    # Simulation position
ros2 topic echo /drone/velocity_setpoint # Simulation control

# Monitor real hardware data  
ros2 topic echo /drone/pose              # Real position
ros2 topic echo /drone/imu               # Real IMU
ros2 topic echo /drone/status            # System health

# View TF tree
ros2 run tf2_tools view_frames
```

---

## ğŸ“¸ Gallery

### RVIZ2 Visualization
![RVIZ2 Display](images/rviz2_display.png)

### Prototype Testing
![Prototype Drone](images/prototype_drone.png)

### Flight Testing
![Drone Flight](images/drone_flight.png)

### Station Test
![Test Stand](images/test_stand.png)

---

## ğŸ“š References

1. **Master Thesis - Emil Jacobsen**
   - "Vectored Thrust Aided Attitude Control for a Single Rotor UAV"
   - https://vbn.aau.dk/ws/files/421577367/Master_Thesis_Emil_Jacobsen_v5.pdf

2. **Thrust Vectoring Control for Heavy UAVs**
   - Isaac, M. S. A., Ragab, A. R., Luna, M. A., Ale Eshagh Khoeini, M. M., & Campoy, P. (2023)
   - Employing a Redundant Communication

3. **Valle et al. (2024)**
   - à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²à¸£à¸°à¸šà¸šà¸„à¸§à¸šà¸„à¸¸à¸¡à¹à¸£à¸‡à¸‚à¸±à¸šà¹à¸šà¸šà¹€à¸šà¸µà¹ˆà¸¢à¸‡à¸—à¸´à¸¨ (thrust vectoring) à¸ªà¸³à¸«à¸£à¸±à¸š Heavy UAVs
   - à¸à¸²à¸£à¸šà¸¹à¸£à¸“à¸²à¸à¸²à¸£à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¹€à¸‹à¸™à¹€à¸‹à¸­à¸£à¹Œ IMU à¹€à¸‚à¹‰à¸²à¸à¸±à¸šà¸£à¸°à¸šà¸šà¸„à¸§à¸šà¸„à¸¸à¸¡à¹à¸šà¸šà¸›à¹‰à¸­à¸™à¸à¸¥à¸±à¸š

4. **ROS2 Documentation**
   - https://docs.ros.org/en/humble/

5. **MicroROS Documentation**
   - https://micro.ros.org/

---

## ğŸ‘¥ Team

**FIBO FRA502 â€“ RoboticsDev Final Project 2025**
**Institute of Field Robotics, King Mongkut's University of Technology Thonburi**

**Project Members:**
- **à¸„à¸¸à¸“à¸²à¸™à¸™à¸•à¹Œ à¹€à¸¨à¸§à¸•à¸„à¸Šà¸à¸¸à¸¥** (66340500006) - System Architecture & Control
- **à¸™à¸²à¸£à¸²à¸Šà¸¥ à¸™à¸£à¸²à¸à¸¸à¸¥à¸à¸±à¸Šà¸£à¹Œ** (66340500027) - Hardware Design & Integration  
- **à¸ à¸¹à¸©à¸´à¸ à¸›à¸£à¸°à¹€à¸ªà¸£à¸´à¸à¸ªà¸¡** (66340500045) - Software Development & ROS2
- **à¸§à¸´à¸Šà¸²à¸ à¸§à¸´à¸Šà¸à¸²à¸™à¸¸à¸ à¸²à¸** (66340500051) - MicroROS & ESP32 Firmware
- **à¸›à¸§à¸£à¸´à¸¨ à¸•à¸±à¹‰à¸‡à¸•à¸£à¸°à¸à¸¹à¸¥** (66340500074) - Testing & Validation

**Institution:**
- Institute of Field Robotics
- King Mongkut's University of Technology Thonburi  
- 126 Pracha Uthit Rd, Bang Mot, Thung Khru, Bangkok, Thailand 10140

---

## ğŸ“ License

This project is developed as part of FIBO FRA502 RoboticsDev coursework.
Copyright Â© 2025 by FIBO, KMUTT

---

## ğŸ™ Acknowledgments

- **ROS2 Community** for the excellent robotics framework
- **MicroROS Team** for embedded ROS2 support
- **Emil Jacobsen** for the foundational thesis on thrust vectoring control
- **FIBO Faculty** and **KMUTT** for project support and facilities
- **Valle et al.** for inspiration from thrust vectoring research

---

## ğŸ“§ Contact

**For questions or collaboration:**
- **Institution:** Institute of Field Robotics, KMUTT
- **Course:** FIBO FRA502 â€“ RoboticsDev Final Project 2025
- **Location:** Bangkok, Thailand

**Project Repository:**
- GitHub: [Repository Link] (To be added)

---

**Project Status:** ğŸ”„ **Week 3 - Development in Progress (Simulation Mode)**  
**Last Updated:** 06 December, 2025
